package services;

import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLEncoder;

import android.app.IntentService;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Messenger;
import android.util.Log;

import com.example.lib.WebStuff;

public class HTTP extends IntentService{
	
	public static final String MESSENGER_KEY = "Messenger";
	public static final String MOVIE_KEY = "movie";
	
	
	public HTTP(){
		super("HTTP");
	}

	@Override
	protected void onHandleIntent(Intent intent) {

		Log.i("HTTP SERVICE", "Started");
		
		//Get extras from MainActivity
		Bundle extras = intent.getExtras();
		Messenger messenger = (Messenger) extras.get(MESSENGER_KEY);
		String _movieName = (String) extras.get(MOVIE_KEY);
		
		// Build URL
			String baseURL = "http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey=zns9a4f2hfm94ju3unu4axzk&q=";
			String qs;
			try {
				qs = URLEncoder.encode(_movieName, "UTF-8");
			} catch (Exception e) {
				Log.e("BAD URL", "ENCODING PROBLEM");
				qs = "";
			}
			
			URL finalURL;
			try {
				finalURL = new URL(baseURL + qs + "&page_limit=1");
				String response = "";
				
					response = WebStuff.getURLStringResponse(finalURL);
				
			} catch (MalformedURLException e) {
				Log.e("BAD URL", "MALFORMED URL");
				finalURL = null;
			}
		

		// Send URL to web stuff to pull data
		class QuoteRequest extends AsyncTask<URL, Void, String> {
			@Override
			protected String doInBackground(URL... urls) {
				
			}

			@Override
			protected void onPostExecute(String result) {
				
			}
		}

	}

}
